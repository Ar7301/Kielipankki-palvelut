# Build some more complex structures from the basic definitions here
wiki_instances:
  - "{{ webdomain_sanat }}"
  - "{{ webdomain_nimiarkisto }}"

vhost_sanat:
  servername: "{{ webdomain_sanat }}"
  serveralias: "{{ webaliases_sanat | join(' ') }}"
  documentroot: /www/{{ webdomain_sanat }}/docroot
  extra_parameters: |
    ProxyPassMatch ^/(.*\.php(/.*)?)$ "fcgi://localhost:{{ hhvm_port }}/www/{{ webdomain_sanat }}/docroot/"
    Alias /js/ /www/smsxml/wiki/js/
    <Directory /www/smsxml/wiki/js>
        Require all granted
    </Directory>

vhost_nimiarkisto:
  servername: "{{ webdomain_nimiarkisto }}"
  serveralias: "{{ webaliases_nimiarkisto | join(' ') }}"
  documentroot: /www/{{ webdomain_nimiarkisto }}/docroot
  extra_parameters: |
    ProxyPassMatch ^/(.*\.php(/.*)?)$ "fcgi://localhost:{{ hhvm_port }}/www/{{ webdomain_nimiarkisto }}/docroot/"

apache_vhosts:
  - "{{ vhost_sanat }}"
  - "{{ vhost_nimiarkisto }}"

apache_vhosts_ssl:
  - "{{ vhost_sanat | combine(ssl_params_sanat) }}"
  - "{{ vhost_nimiarkisto | combine(ssl_params_nimiarkisto) }}"
